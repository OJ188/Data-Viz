}
label_max = paste(c(State[Q==max(Q)],":", ceiling(max(Q)),"$/oz."), collapse = " ")
label_mean = paste(c("Mean :", ceiling(mean(Q)),"$/oz."), collapse = " ")
Q
Q = c(HighQ)
label_max = paste(c(State[Q==max(Q)],":", ceiling(max(Q)),"$/oz."), collapse = " ")
Q = data.frame(HighQ)
label_max = paste(c(State[Q==max(Q)],":", ceiling(max(Q)),"$/oz."), collapse = " ")
label_max = paste(c(State[Q==max(Q)],":", ceiling(max(Q)),"$/oz."), collapse = " ")
label_mean = paste(c("Mean :", ceiling(mean(Q)),"$/oz."), collapse = " ")
label_min = paste(c(State[Q==min(Q)],":", ceiling(min(Q)),"$/oz."), collapse = " ")
label_max = paste(c(State[Q==max(Q)],":", ceiling(max(Q)),"$/oz."), collapse = " ")
label_mean = paste(c("Mean :", ceiling(mean(Q)),"$/oz."), collapse = " ")
attach(Q)
names(Q) = "Q"
attach(Q)
label_max = paste(c(State[Q==max(Q)],":", ceiling(max(Q)),"$/oz."), collapse = " ")
label_mean = paste(c("Mean :", ceiling(mean(Q)),"$/oz."), collapse = " ")
label_min = paste(c(State[Q==min(Q)],":", ceiling(min(Q)),"$/oz."), collapse = " ")
# Reorder
Mean_state %>%
arrange(Q) %>%
mutate(State=factor(State,State)) %>%
ggplot(aes(x=State, y=Q)) +
geom_segment( aes(x=State, xend=State, y=0, yend=Q), color="skyblue") +
geom_point( size=3, color="red", fill=alpha("orange", 0.3), alpha=0.7, shape=21, stroke=2) +
theme_light() +
coord_flip() +
theme(
panel.grid.major.y = element_blank(),
panel.border = element_blank(),
axis.ticks.y = element_blank()
) +
ylab("Mean price per state") +
annotate("text", x=State[Q==max(Q)], y=max(Q) - 130,
# label=("North Dakota : 415$/oz."), color="red") +
label=label_max, color="red") +
annotate(geom="point", State[Q==max(Q)], y=max(Q), shape=21, size=10, fill="transparent", color="red") +
annotate("text", x=State[Q==min(Q)], y=min(Q) - 100,
label=("Oregon : 208$/oz."), color="red") +
annotate(geom="point", State[Q==min(Q)], y=min(Q), shape=21, size=10, fill="transparent", color="red") +
geom_hline(yintercept=mean(Q), color="blue", size=.5) +
annotate("text", x=State[Q==min(Q)], y=min(Q) + 100,
label=label_mean, color="blue")
if(Choix==1)
{
Mean_state = aggregate(HighQ~State, data=df, FUN=function(df) c(mean=mean(df), count=length(df)))
Mean_state$HighQ = Mean_state$HighQ[1:51]
attach(Mean_state)
Q = data.frame(HighQ)
names(Q) = "Q"
attach(Q)
}
label_max = paste(c(State[Q==max(Q)],":", ceiling(max(Q)),"$/oz."), collapse = " ")
label_mean = paste(c("Mean :", ceiling(mean(Q)),"$/oz."), collapse = " ")
str(Q)
# Choix = 2
# Choix = 3
if(Choix==1)
{
Mean_state = aggregate(HighQ~State, data=df, FUN=function(df) c(mean=mean(df), count=length(df)))
Mean_state$HighQ = Mean_state$HighQ[1:51]
attach(Mean_state)
Quality = data.frame(HighQ)
}
if(Choix==2)
{
Mean_state = data.frame(aggregate(MedQ~State, data=df, FUN=function(df) c(mean=mean(df), count=length(df))))
Mean_state$MedQ = Mean_state$MedQ[1:51]
attach(Mean_state)
Quality = data.frame(MedQ)
}
if(Choix==3)
{
Mean_state = data.frame(aggregate(LowQ~State, data=df, FUN=function(df) c(mean=mean(df), count=length(df))))
Mean_state$LowQ = Mean_state$LowQ[1:51]
attach(Mean_state)
Quality = data.frame(LowQ)
}
names(Quality) = "Q"
attach(Quality)
label_max = paste(c(State[Q==max(Q)],":", ceiling(max(Q)),"$/oz."), collapse = " ")
label_mean = paste(c("Mean :", ceiling(mean(Q)),"$/oz."), collapse = " ")
label_min = paste(c(State[Q==min(Q)],":", ceiling(min(Q)),"$/oz."), collapse = " ")
str(Q)
str(State)
Q$Q
label_max = paste(c(State[Q==max(Q)],":", ceiling(max(Q)),"$/oz."), collapse = " ")
label_mean = paste(c("Mean :", ceiling(mean(Q$Q)),"$/oz."), collapse = " ")
label_min = paste(c(State[Q==min(Q)],":", ceiling(min(Q)),"$/oz."), collapse = " ")
# Reorder
Mean_state %>%
arrange(Q) %>%
mutate(State=factor(State,State)) %>%
ggplot(aes(x=State, y=Q)) +
geom_segment( aes(x=State, xend=State, y=0, yend=Q), color="skyblue") +
geom_point( size=3, color="red", fill=alpha("orange", 0.3), alpha=0.7, shape=21, stroke=2) +
theme_light() +
coord_flip() +
theme(
panel.grid.major.y = element_blank(),
panel.border = element_blank(),
axis.ticks.y = element_blank()
) +
ylab("Mean price per state") +
annotate("text", x=State[Q==max(Q)], y=max(Q) - 130,
# label=("North Dakota : 415$/oz."), color="red") +
label=label_max, color="red") +
annotate(geom="point", State[Q==max(Q)], y=max(Q), shape=21, size=10, fill="transparent", color="red") +
annotate("text", x=State[Q==min(Q)], y=min(Q) - 100,
label=("Oregon : 208$/oz."), color="red") +
annotate(geom="point", State[Q==min(Q)], y=min(Q), shape=21, size=10, fill="transparent", color="red") +
geom_hline(yintercept=mean(Q), color="blue", size=.5) +
annotate("text", x=State[Q==min(Q)], y=min(Q) + 100,
label=label_mean, color="blue")
# Reorder
Mean_state %>%
arrange(Q$Q) %>%
mutate(State=factor(State,State)) %>%
ggplot(aes(x=State, y=Q$Q)) +
geom_segment( aes(x=State, xend=State, y=0, yend=Q), color="skyblue") +
geom_point( size=3, color="red", fill=alpha("orange", 0.3), alpha=0.7, shape=21, stroke=2) +
theme_light() +
coord_flip() +
theme(
panel.grid.major.y = element_blank(),
panel.border = element_blank(),
axis.ticks.y = element_blank()
) +
ylab("Mean price per state") +
annotate("text", x=State[Q$Q==max(Q$Q)], y=max(Q$Q) - 130,
# label=("North Dakota : 415$/oz."), color="red") +
label=label_max, color="red") +
annotate(geom="point", State[Q$Q==max(Q$Q)], y=max(Q$Q), shape=21, size=10, fill="transparent", color="red") +
annotate("text", x=State[Q$Q==min(Q$Q)], y=min(Q$Q) - 100,
label=("Oregon : 208$/oz."), color="red") +
annotate(geom="point", State[Q$Q==min(Q$Q)], y=min(Q$Q), shape=21, size=10, fill="transparent", color="red") +
geom_hline(yintercept=mean(Q$Q), color="blue", size=.5) +
annotate("text", x=State[Q$Q==min(Q$Q)], y=min(Q$Q) + 100,
label=label_mean, color="blue")
# Reorder
Mean_state %>%
arrange(Q$Q) %>%
mutate(State=factor(State,State)) %>%
ggplot(aes(x=State, y=Q$Q)) +
geom_segment( aes(x=State, xend=State, y=0, yend=Q), color="skyblue") +
geom_point( size=3, color="red", fill=alpha("orange", 0.3), alpha=0.7, shape=21, stroke=2) +
theme_light() +
coord_flip() +
theme(
panel.grid.major.y = element_blank(),
panel.border = element_blank(),
axis.ticks.y = element_blank()
) +
ylab("Mean price per state") +
annotate("text", x=State[Q$Q==max(Q)], y=max(Q) - 130,
# label=("North Dakota : 415$/oz."), color="red") +
label=label_max, color="red") +
annotate(geom="point", State[Q$Q==max(Q)], y=max(Q), shape=21, size=10, fill="transparent", color="red") +
annotate("text", x=State[Q$Q==min(Q)], y=min(Q) - 100,
label=("Oregon : 208$/oz."), color="red") +
annotate(geom="point", State[Q$Q==min(Q)], y=min(Q), shape=21, size=10, fill="transparent", color="red") +
geom_hline(yintercept=mean(Q$Q), color="blue", size=.5) +
annotate("text", x=State[Q$Q==min(Q)], y=min(Q) + 100,
label=label_mean, color="blue")
# Reorder
Mean_state %>%
arrange(Q$Q) %>%
mutate(State=factor(State,State)) %>%
ggplot(aes(x=State, y=Q)) +
geom_segment( aes(x=State, xend=State, y=0, yend=Q), color="skyblue") +
geom_point( size=3, color="red", fill=alpha("orange", 0.3), alpha=0.7, shape=21, stroke=2) +
theme_light() +
coord_flip() +
theme(
panel.grid.major.y = element_blank(),
panel.border = element_blank(),
axis.ticks.y = element_blank()
) +
ylab("Mean price per state") +
annotate("text", x=State[Q==max(Q)], y=max(Q) - 130,
# label=("North Dakota : 415$/oz."), color="red") +
label=label_max, color="red") +
annotate(geom="point", State[Q==max(Q)], y=max(Q), shape=21, size=10, fill="transparent", color="red") +
annotate("text", x=State[Q==min(Q)], y=min(Q) - 100,
label=("Oregon : 208$/oz."), color="red") +
annotate(geom="point", State[Q==min(Q)], y=min(Q), shape=21, size=10, fill="transparent", color="red") +
geom_hline(yintercept=mean(Q$Q), color="blue", size=.5) +
annotate("text", x=State[Q==min(Q)], y=min(Q) + 100,
label=label_mean, color="blue")
devtools::install_github('cran/ggplot2')
# Reorder
Mean_state %>%
arrange(Q$Q) %>%
mutate(State=factor(State,State)) %>%
ggplot(aes(x=State, y=Q)) +
geom_segment( aes(x=State, xend=State, y=0, yend=Q), color="skyblue") +
geom_point( size=3, color="red", fill=alpha("orange", 0.3), alpha=0.7, shape=21, stroke=2) +
theme_light() +
coord_flip() +
theme(
panel.grid.major.y = element_blank(),
panel.border = element_blank(),
axis.ticks.y = element_blank()
) +
ylab("Mean price per state") +
annotate("text", x=State[Q==max(Q)], y=max(Q) - 130,
# label=("North Dakota : 415$/oz."), color="red") +
label=label_max, color="red") +
annotate(geom="point", State[Q==max(Q)], y=max(Q), shape=21, size=10, fill="transparent", color="red") +
annotate("text", x=State[Q==min(Q)], y=min(Q) - 100,
label=("Oregon : 208$/oz."), color="red") +
annotate(geom="point", State[Q==min(Q)], y=min(Q), shape=21, size=10, fill="transparent", color="red") +
geom_hline(yintercept=mean(Q$Q), color="blue", size=.5) +
annotate("text", x=State[Q==min(Q)], y=min(Q) + 100,
label=label_mean, color="blue")
installed.packages("ggplot2")
# Reorder
Mean_state %>%
arrange(Q) %>%
mutate(State=factor(State,State)) %>%
ggplot(aes(x=State, y=Q)) +
geom_segment( aes(x=State, xend=State, y=0, yend=Q), color="skyblue") +
geom_point( size=3, color="red", fill=alpha("orange", 0.3), alpha=0.7, shape=21, stroke=2) +
theme_light() +
coord_flip() +
theme(
panel.grid.major.y = element_blank(),
panel.border = element_blank(),
axis.ticks.y = element_blank()
) +
ylab("Mean price per state") +
annotate("text", x=State[Q==max(Q)], y=max(Q) - 130,
# label=("North Dakota : 415$/oz."), color="red") +
label=label_max, color="red") +
annotate(geom="point", State[Q==max(Q)], y=max(Q), shape=21, size=10, fill="transparent", color="red") +
annotate("text", x=State[Q==min(Q)], y=min(Q) - 100,
label=("Oregon : 208$/oz."), color="red") +
annotate(geom="point", State[Q==min(Q)], y=min(Q), shape=21, size=10, fill="transparent", color="red") +
geom_hline(yintercept=mean(Q$Q), color="blue", size=.5) +
annotate("text", x=State[Q==min(Q)], y=min(Q) + 100,
label=label_mean, color="blue")
# Reorder
Mean_state %>%
arrange(Q$Q) %>%
mutate(State=factor(State,State)) %>%
ggplot(aes(x=State, y=Q$Q)) +
geom_segment( aes(x=State, xend=State, y=0, yend=Q), color="skyblue") +
geom_point( size=3, color="red", fill=alpha("orange", 0.3), alpha=0.7, shape=21, stroke=2) +
theme_light() +
coord_flip() +
theme(
panel.grid.major.y = element_blank(),
panel.border = element_blank(),
axis.ticks.y = element_blank()
) +
ylab("Mean price per state") +
annotate("text", x=State[Q==max(Q)], y=max(Q) - 130,
# label=("North Dakota : 415$/oz."), color="red") +
label=label_max, color="red") +
annotate(geom="point", State[Q==max(Q)], y=max(Q), shape=21, size=10, fill="transparent", color="red") +
annotate("text", x=State[Q==min(Q)], y=min(Q) - 100,
label=("Oregon : 208$/oz."), color="red") +
annotate(geom="point", State[Q==min(Q)], y=min(Q), shape=21, size=10, fill="transparent", color="red") +
geom_hline(yintercept=mean(Q$Q), color="blue", size=.5) +
annotate("text", x=State[Q==min(Q)], y=min(Q) + 100,
label=label_mean, color="blue")
# Reorder
Mean_state %>%
arrange(Q$Q) %>%
mutate(State=factor(State,State)) %>%
ggplot(aes(x=State, y=Q$Q)) +
geom_segment( aes(x=State, xend=State, y=0, yend=Q$Q), color="skyblue") +
geom_point( size=3, color="red", fill=alpha("orange", 0.3), alpha=0.7, shape=21, stroke=2) +
theme_light() +
coord_flip() +
theme(
panel.grid.major.y = element_blank(),
panel.border = element_blank(),
axis.ticks.y = element_blank()
) +
ylab("Mean price per state") +
annotate("text", x=State[Q==max(Q)], y=max(Q) - 130,
# label=("North Dakota : 415$/oz."), color="red") +
label=label_max, color="red") +
annotate(geom="point", State[Q==max(Q)], y=max(Q), shape=21, size=10, fill="transparent", color="red") +
annotate("text", x=State[Q==min(Q)], y=min(Q) - 100,
label=("Oregon : 208$/oz."), color="red") +
annotate(geom="point", State[Q==min(Q)], y=min(Q), shape=21, size=10, fill="transparent", color="red") +
geom_hline(yintercept=mean(Q$Q), color="blue", size=.5) +
annotate("text", x=State[Q==min(Q)], y=min(Q) + 100,
label=label_mean, color="blue")
###### OPENING FILE
df = read.table("Weed_Price.csv",header=TRUE,sep=",",dec=".",stringsAsFactors = TRUE)
attach(df)
date <- as.Date(date)
###### COMPLETING MISSING VALUES WITH LAST NONE NA VALUE
df = df[with(df, order(State,date)),]
na.locf(df)
# 1) HighQ 2) MedQ 3) LowQ
Choix = 1
# Choix = 2
# Choix = 3
if(Choix==1)
{
Mean_state = aggregate(HighQ~State, data=df, FUN=function(df) c(mean=mean(df), count=length(df)))
Mean_state$HighQ = Mean_state$HighQ[1:51]
attach(Mean_state)
Quality = data.frame(HighQ)
}
names(Quality) = "Q"
attach(Quality)
label_max = paste(c(State[Q==max(Q)],":", ceiling(max(Q)),"$/oz."), collapse = " ")
label_mean = paste(c("Mean :", ceiling(mean(Q$Q)),"$/oz."), collapse = " ")
label_min = paste(c(State[Q==min(Q)],":", ceiling(min(Q)),"$/oz."), collapse = " ")
# Reorder
Mean_state %>%
arrange(Q$Q) %>%
mutate(State=factor(State,State)) %>%
ggplot(aes(x=State, y=Q$Q)) +
geom_segment( aes(x=State, xend=State, y=0, yend=Q$Q), color="skyblue") +
geom_point( size=3, color="red", fill=alpha("orange", 0.3), alpha=0.7, shape=21, stroke=2) +
theme_light() +
coord_flip() +
theme(
panel.grid.major.y = element_blank(),
panel.border = element_blank(),
axis.ticks.y = element_blank()
) +
ylab("Mean price per state") +
annotate("text", x=State[Q==max(Q)], y=max(Q) - 130,
# label=("North Dakota : 415$/oz."), color="red") +
label=label_max, color="red") +
annotate(geom="point", State[Q==max(Q)], y=max(Q), shape=21, size=10, fill="transparent", color="red") +
annotate("text", x=State[Q==min(Q)], y=min(Q) - 100,
label=("Oregon : 208$/oz."), color="red") +
annotate(geom="point", State[Q==min(Q)], y=min(Q), shape=21, size=10, fill="transparent", color="red") +
geom_hline(yintercept=mean(Q$Q), color="blue", size=.5) +
annotate("text", x=State[Q==min(Q)], y=min(Q) + 100,
label=label_mean, color="blue")
# Reorder
p = Mean_state %>%
arrange(HighQ) %>%
mutate(State=factor(State,State)) %>%
ggplot(aes(x=State, y=HighQ)) +
geom_segment( aes(x=State, xend=State, y=0, yend=HighQ), color=ifelse((State=="North Dakota" | State=="Oregon"), "orange", "grey"), size=ifelse((State=="North Dakota" | State=="Oregon"), 1.3, 0.7)) +
geom_point( color=ifelse((State=="North Dakota" | State=="Oregon"), "orange", "grey"), size=ifelse((State=="North Dakota" | State=="Oregon"), 5, 2) ) +
theme_light() +
coord_flip() +
theme(
panel.grid.major.y = element_blank(),
panel.border = element_blank(),
axis.ticks.y = element_blank()
) +
ylab("Mean price per state") +
annotate("text", x=State[HighQ==max(HighQ)], y=max(HighQ) - 100,
label=("North Dakota : 1 oz. (28g), 415$")) +
annotate(geom="point", State[HighQ==max(HighQ)], y=max(HighQ), shape=21, size=10, fill="transparent") +
annotate("text", x=State[HighQ==min(HighQ)], y=min(HighQ) - 100,
label=("Oregon : 1 oz. (28g), 208$")) +
annotate(geom="point", State[HighQ==min(HighQ)], y=min(HighQ), shape=21, size=10, fill="transparent") +
geom_hline(yintercept=mean(HighQ), color="orange", size=.5)
Mean_state = aggregate(HighQ~State, data=df, FUN=function(df) c(mean=mean(df), count=length(df)))
Mean_state$HighQ = Mean_state$HighQ[1:51]
attach(Mean_state)
label_max = paste(c(State[HighQ==max(HighQ)],":", ceiling(max(HighQ)),"$/oz."), collapse = " ")
Mean_state = data.frame(aggregate(HighQ~State, data=df, FUN=function(df) c(mean=mean(df), count=length(df))))
Mean_state$HighQ = Mean_state$HighQ[1:51]
attach(Mean_state)
label_max = paste(c(State[HighQ==max(HighQ)],":", ceiling(max(HighQ)),"$/oz."), collapse = " ")
library(zoo)
library(ggplot2)
library(dplyr)
library(hrbrthemes)
library(viridis)
library(plotly)
library(tidyverse)
library(dygraphs)
library(xts)          # To make the convertion data-frame / xts format
library(lubridate)
###### OPENING FILE
df = read.table("Weed_Price.csv",header=TRUE,sep=",",dec=".",stringsAsFactors = TRUE)
attach(df)
date <- as.Date(date)
###### COMPLETING MISSING VALUES WITH LAST NONE NA VALUE
df = df[with(df, order(State,date)),]
na.locf(df)
Mean_state = data.frame(aggregate(HighQ~State, data=df, FUN=function(df) c(mean=mean(df), count=length(df))))
Mean_state$HighQ = Mean_state$HighQ[1:51]
attach(Mean_state)
label_max = paste(c(State[HighQ==max(HighQ)],":", ceiling(max(HighQ)),"$/oz."), collapse = " ")
label_mean = paste(c("Mean :", ceiling(mean(HighQ)),"$/oz."), collapse = " ")
label_min = paste(c(State[HighQ==min(HighQ)],":", ceiling(min(HighQ)),"$/oz."), collapse = " ")
# Reorder
Mean_state %>%
arrange(HighQ) %>%
mutate(State=factor(State,State)) %>%
ggplot(aes(x=State, y=HighQ)) +
geom_segment( aes(x=State, xend=State, y=0, yend=HighQ), color="skyblue") +
geom_point( size=3, color="red", fill=alpha("orange", 0.3), alpha=0.7, shape=21, stroke=2) +
theme_light() +
coord_flip() +
theme(
panel.grid.major.y = element_blank(),
panel.border = element_blank(),
axis.ticks.y = element_blank()
) +
ylab("Mean price per state") +
annotate("text", x=State[HighQ==max(HighQ)], y=max(HighQ) - 130,
# label=("North Dakota : 415$/oz."), color="red") +
label=label_max, color="red") +
annotate(geom="point", State[HighQ==max(HighQ)], y=max(HighQ), shape=21, size=10, fill="transparent", color="red") +
annotate("text", x=State[HighQ==min(HighQ)], y=min(HighQ) - 100,
label=("Oregon : 208$/oz."), color="red") +
annotate(geom="point", State[HighQ==min(HighQ)], y=min(HighQ), shape=21, size=10, fill="transparent", color="red") +
geom_hline(yintercept=mean(HighQ), color="blue", size=.5) +
annotate("text", x=State[HighQ==min(HighQ)], y=min(HighQ) + 100,
label=label_mean, color="blue")
Mean_state = aggregate(HighQ~State, data=df, FUN=function(df) c(mean=mean(df), count=length(df)))
Mean_state$HighQ = Mean_state$HighQ[1:51]
attach(Mean_state)
Quality = data.frame(HighQ)
names(Quality) = "Q"
attach(Quality)
label_max = paste(c(State[Q==max(Q)],":", ceiling(max(Q)),"$/oz."), collapse = " ")
label_mean = paste(c("Mean :", ceiling(mean(Q$Q)),"$/oz."), collapse = " ")
label_mean = paste(c("Mean :", ceiling(mean(Q)),"$/oz."), collapse = " ")
label_min = paste(c(State[Q==min(Q)],":", ceiling(min(Q)),"$/oz."), collapse = " ")
# Reorder
Mean_state %>%
arrange(Q$Q) %>%
mutate(State=factor(State,State)) %>%
ggplot(aes(x=State, y=Q$Q)) +
geom_segment( aes(x=State, xend=State, y=0, yend=Q$Q), color="skyblue") +
geom_point( size=3, color="red", fill=alpha("orange", 0.3), alpha=0.7, shape=21, stroke=2) +
theme_light() +
coord_flip() +
theme(
panel.grid.major.y = element_blank(),
panel.border = element_blank(),
axis.ticks.y = element_blank()
) +
ylab("Mean price per state") +
annotate("text", x=State[Q==max(Q)], y=max(Q) - 130,
# label=("North Dakota : 415$/oz."), color="red") +
label=label_max, color="red") +
annotate(geom="point", State[Q==max(Q)], y=max(Q), shape=21, size=10, fill="transparent", color="red") +
annotate("text", x=State[Q==min(Q)], y=min(Q) - 100,
label=("Oregon : 208$/oz."), color="red") +
annotate(geom="point", State[Q==min(Q)], y=min(Q), shape=21, size=10, fill="transparent", color="red") +
geom_hline(yintercept=mean(Q$Q), color="blue", size=.5) +
annotate("text", x=State[Q==min(Q)], y=min(Q) + 100,
label=label_mean, color="blue")
# Reorder
Mean_state %>%
arrange(Q) %>%
mutate(State=factor(State,State)) %>%
ggplot(aes(x=State, y=Q)) +
geom_segment( aes(x=State, xend=State, y=0, yend=Q), color="skyblue") +
geom_point( size=3, color="red", fill=alpha("orange", 0.3), alpha=0.7, shape=21, stroke=2) +
theme_light() +
coord_flip() +
theme(
panel.grid.major.y = element_blank(),
panel.border = element_blank(),
axis.ticks.y = element_blank()
) +
ylab("Mean price per state") +
annotate("text", x=State[Q==max(Q)], y=max(Q) - 130,
# label=("North Dakota : 415$/oz."), color="red") +
label=label_max, color="red") +
annotate(geom="point", State[Q==max(Q)], y=max(Q), shape=21, size=10, fill="transparent", color="red") +
annotate("text", x=State[Q==min(Q)], y=min(Q) - 100,
label=("Oregon : 208$/oz."), color="red") +
annotate(geom="point", State[Q==min(Q)], y=min(Q), shape=21, size=10, fill="transparent", color="red") +
geom_hline(yintercept=mean(Q), color="blue", size=.5) +
annotate("text", x=State[Q==min(Q)], y=min(Q) + 100,
label=label_mean, color="blue")
Mean_state = data.frame(aggregate(HighQ~State, data=df, FUN=function(df) c(mean=mean(df), count=length(df))))
Mean_state$HighQ = Mean_state$HighQ[1:51]
attach(Mean_state)
label_max = paste(c(State[HighQ==max(HighQ)],":", ceiling(max(HighQ)),"$/oz."), collapse = " ")
label_mean = paste(c("Mean :", ceiling(mean(HighQ)),"$/oz."), collapse = " ")
label_min = paste(c(State[HighQ==min(HighQ)],":", ceiling(min(HighQ)),"$/oz."), collapse = " ")
# Reorder
Mean_state %>%
arrange(HighQ) %>%
mutate(State=factor(State,State)) %>%
ggplot(aes(x=State, y=HighQ)) +
geom_segment( aes(x=State, xend=State, y=0, yend=HighQ), color="skyblue") +
geom_point( size=3, color="red", fill=alpha("orange", 0.3), alpha=0.7, shape=21, stroke=2) +
theme_light() +
coord_flip() +
theme(
panel.grid.major.y = element_blank(),
panel.border = element_blank(),
axis.ticks.y = element_blank()
) +
ylab("Mean price per state") +
annotate("text", x=State[HighQ==max(HighQ)], y=max(HighQ) - 130,
# label=("North Dakota : 415$/oz."), color="red") +
label=label_max, color="red") +
annotate(geom="point", State[HighQ==max(HighQ)], y=max(HighQ), shape=21, size=10, fill="transparent", color="red") +
annotate("text", x=State[HighQ==min(HighQ)], y=min(HighQ) - 100,
label=("Oregon : 208$/oz."), color="red") +
annotate(geom="point", State[HighQ==min(HighQ)], y=min(HighQ), shape=21, size=10, fill="transparent", color="red") +
geom_hline(yintercept=mean(HighQ), color="blue", size=.5) +
annotate("text", x=State[HighQ==min(HighQ)], y=min(HighQ) + 100,
label=label_mean, color="blue")
str(sta)
stack
str(State)
